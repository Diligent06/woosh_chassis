ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 1


   1              		.cpu cortex-m7
   2              		.arch armv7e-m
   3              		.fpu fpv5-d16
   4              		.eabi_attribute 28, 1
   5              		.eabi_attribute 20, 1
   6              		.eabi_attribute 21, 1
   7              		.eabi_attribute 23, 3
   8              		.eabi_attribute 24, 1
   9              		.eabi_attribute 25, 1
  10              		.eabi_attribute 26, 1
  11              		.eabi_attribute 30, 6
  12              		.eabi_attribute 34, 1
  13              		.eabi_attribute 18, 4
  14              		.file	"stm32h7xx_hal_pcd_ex.c"
  15              		.text
  16              	.Ltext0:
  17              		.cfi_sections	.debug_frame
  18              		.section	.text.HAL_PCDEx_SetTxFiFo,"ax",%progbits
  19              		.align	1
  20              		.global	HAL_PCDEx_SetTxFiFo
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	HAL_PCDEx_SetTxFiFo:
  26              	.LFB144:
  27              		.file 1 "Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c"
   1:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
   2:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   ******************************************************************************
   3:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @file    stm32h7xx_hal_pcd_ex.c
   4:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @author  MCD Application Team
   5:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief   PCD Extended HAL module driver.
   6:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   *          This file provides firmware functions to manage the following
   7:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   *          functionalities of the USB Peripheral Controller:
   8:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   *           + Extended features functions
   9:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   *
  10:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   ******************************************************************************
  11:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @attention
  12:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   *
  13:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * Copyright (c) 2017 STMicroelectronics.
  14:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * All rights reserved.
  15:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   *
  16:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * This software is licensed under terms that can be found in the LICENSE file
  17:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * in the root directory of this software component.
  18:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * If no LICENSE file comes with this software, it is provided AS-IS.
  19:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   *
  20:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   ******************************************************************************
  21:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
  22:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  23:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /* Includes ------------------------------------------------------------------*/
  24:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #include "stm32h7xx_hal.h"
  25:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  26:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /** @addtogroup STM32H7xx_HAL_Driver
  27:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @{
  28:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
  29:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  30:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /** @defgroup PCDEx PCDEx
  31:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief PCD Extended HAL module driver
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 2


  32:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @{
  33:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
  34:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  35:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #ifdef HAL_PCD_MODULE_ENABLED
  36:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  37:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #if defined (USB_OTG_FS) || defined (USB_OTG_HS)
  38:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /* Private types -------------------------------------------------------------*/
  39:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /* Private variables ---------------------------------------------------------*/
  40:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /* Private constants ---------------------------------------------------------*/
  41:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /* Private macros ------------------------------------------------------------*/
  42:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /* Private functions ---------------------------------------------------------*/
  43:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /* Exported functions --------------------------------------------------------*/
  44:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  45:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /** @defgroup PCDEx_Exported_Functions PCDEx Exported Functions
  46:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @{
  47:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
  48:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  49:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /** @defgroup PCDEx_Exported_Functions_Group1 Peripheral Control functions
  50:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief    PCDEx control functions
  51:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   *
  52:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** @verbatim
  53:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****  ===============================================================================
  54:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****                  ##### Extended features functions #####
  55:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****  ===============================================================================
  56:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     [..]  This section provides functions allowing to:
  57:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****       (+) Update FIFO configuration
  58:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  59:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** @endverbatim
  60:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @{
  61:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
  62:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #if defined (USB_OTG_FS) || defined (USB_OTG_HS)
  63:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
  64:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief  Set Tx FIFO
  65:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  hpcd PCD handle
  66:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  fifo The number of Tx fifo
  67:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  size Fifo size
  68:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @retval HAL status
  69:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
  70:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** HAL_StatusTypeDef HAL_PCDEx_SetTxFiFo(PCD_HandleTypeDef *hpcd, uint8_t fifo, uint16_t size)
  71:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** {
  28              		.loc 1 71 1
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 16
  31              		@ frame_needed = 1, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33 0000 80B4     		push	{r7}
  34              	.LCFI0:
  35              		.cfi_def_cfa_offset 4
  36              		.cfi_offset 7, -4
  37 0002 85B0     		sub	sp, sp, #20
  38              	.LCFI1:
  39              		.cfi_def_cfa_offset 24
  40 0004 00AF     		add	r7, sp, #0
  41              	.LCFI2:
  42              		.cfi_def_cfa_register 7
  43 0006 7860     		str	r0, [r7, #4]
  44 0008 0B46     		mov	r3, r1
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 3


  45 000a FB70     		strb	r3, [r7, #3]
  46 000c 1346     		mov	r3, r2	@ movhi
  47 000e 3B80     		strh	r3, [r7]	@ movhi
  72:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   uint8_t i;
  73:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   uint32_t Tx_Offset;
  74:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  75:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /*  TXn min size = 16 words. (n  : Transmit FIFO index)
  76:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****       When a TxFIFO is not used, the Configuration should be as follows:
  77:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****           case 1 :  n > m    and Txn is not used    (n,m  : Transmit FIFO indexes)
  78:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****          --> Txm can use the space allocated for Txn.
  79:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****          case2  :  n < m    and Txn is not used    (n,m  : Transmit FIFO indexes)
  80:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****          --> Txn should be configured with the minimum space of 16 words
  81:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****      The FIFO is used optimally when used TxFIFOs are allocated in the top
  82:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****          of the FIFO.Ex: use EP1 and EP2 as IN instead of EP1 and EP3 as IN ones.
  83:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****      When DMA is used 3n * FIFO locations should be reserved for internal DMA registers */
  84:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  85:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   Tx_Offset = hpcd->Instance->GRXFSIZ;
  48              		.loc 1 85 19
  49 0010 7B68     		ldr	r3, [r7, #4]
  50 0012 1B68     		ldr	r3, [r3]
  51              		.loc 1 85 13
  52 0014 5B6A     		ldr	r3, [r3, #36]
  53 0016 BB60     		str	r3, [r7, #8]
  86:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  87:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   if (fifo == 0U)
  54              		.loc 1 87 6
  55 0018 FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
  56 001a 002B     		cmp	r3, #0
  57 001c 07D1     		bne	.L2
  88:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   {
  89:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     hpcd->Instance->DIEPTXF0_HNPTXFSIZ = ((uint32_t)size << 16) | Tx_Offset;
  58              		.loc 1 89 43
  59 001e 3B88     		ldrh	r3, [r7]
  60              		.loc 1 89 58
  61 0020 1904     		lsls	r1, r3, #16
  62              		.loc 1 89 9
  63 0022 7B68     		ldr	r3, [r7, #4]
  64 0024 1B68     		ldr	r3, [r3]
  65              		.loc 1 89 65
  66 0026 BA68     		ldr	r2, [r7, #8]
  67 0028 0A43     		orrs	r2, r2, r1
  68              		.loc 1 89 40
  69 002a 9A62     		str	r2, [r3, #40]
  70 002c 28E0     		b	.L3
  71              	.L2:
  90:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   }
  91:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   else
  92:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   {
  93:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     Tx_Offset += (hpcd->Instance->DIEPTXF0_HNPTXFSIZ) >> 16;
  72              		.loc 1 93 23
  73 002e 7B68     		ldr	r3, [r7, #4]
  74 0030 1B68     		ldr	r3, [r3]
  75              		.loc 1 93 33
  76 0032 9B6A     		ldr	r3, [r3, #40]
  77              		.loc 1 93 55
  78 0034 1B0C     		lsrs	r3, r3, #16
  79              		.loc 1 93 15
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 4


  80 0036 BA68     		ldr	r2, [r7, #8]
  81 0038 1344     		add	r3, r3, r2
  82 003a BB60     		str	r3, [r7, #8]
  94:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     for (i = 0U; i < (fifo - 1U); i++)
  83              		.loc 1 94 12
  84 003c 0023     		movs	r3, #0
  85 003e FB73     		strb	r3, [r7, #15]
  86              		.loc 1 94 5
  87 0040 0DE0     		b	.L4
  88              	.L5:
  95:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     {
  96:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****       Tx_Offset += (hpcd->Instance->DIEPTXF[i] >> 16);
  89              		.loc 1 96 25 discriminator 3
  90 0042 7B68     		ldr	r3, [r7, #4]
  91 0044 1A68     		ldr	r2, [r3]
  92              		.loc 1 96 44 discriminator 3
  93 0046 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
  94 0048 4033     		adds	r3, r3, #64
  95 004a 9B00     		lsls	r3, r3, #2
  96 004c 1344     		add	r3, r3, r2
  97 004e 5B68     		ldr	r3, [r3, #4]
  98              		.loc 1 96 48 discriminator 3
  99 0050 1B0C     		lsrs	r3, r3, #16
 100              		.loc 1 96 17 discriminator 3
 101 0052 BA68     		ldr	r2, [r7, #8]
 102 0054 1344     		add	r3, r3, r2
 103 0056 BB60     		str	r3, [r7, #8]
  94:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     for (i = 0U; i < (fifo - 1U); i++)
 104              		.loc 1 94 36 discriminator 3
 105 0058 FB7B     		ldrb	r3, [r7, #15]	@ zero_extendqisi2
 106 005a 0133     		adds	r3, r3, #1
 107 005c FB73     		strb	r3, [r7, #15]
 108              	.L4:
  94:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     for (i = 0U; i < (fifo - 1U); i++)
 109              		.loc 1 94 20 discriminator 1
 110 005e FA7B     		ldrb	r2, [r7, #15]	@ zero_extendqisi2
  94:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     for (i = 0U; i < (fifo - 1U); i++)
 111              		.loc 1 94 28 discriminator 1
 112 0060 FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
 113 0062 013B     		subs	r3, r3, #1
  94:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     for (i = 0U; i < (fifo - 1U); i++)
 114              		.loc 1 94 5 discriminator 1
 115 0064 9A42     		cmp	r2, r3
 116 0066 ECD3     		bcc	.L5
  97:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     }
  98:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
  99:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     /* Multiply Tx_Size by 2 to get higher performance */
 100:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     hpcd->Instance->DIEPTXF[fifo - 1U] = ((uint32_t)size << 16) | Tx_Offset;
 117              		.loc 1 100 43
 118 0068 3B88     		ldrh	r3, [r7]
 119              		.loc 1 100 58
 120 006a 1804     		lsls	r0, r3, #16
 121              		.loc 1 100 9
 122 006c 7B68     		ldr	r3, [r7, #4]
 123 006e 1968     		ldr	r1, [r3]
 124              		.loc 1 100 34
 125 0070 FB78     		ldrb	r3, [r7, #3]	@ zero_extendqisi2
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 5


 126 0072 013B     		subs	r3, r3, #1
 127              		.loc 1 100 65
 128 0074 BA68     		ldr	r2, [r7, #8]
 129 0076 0243     		orrs	r2, r2, r0
 130              		.loc 1 100 40
 131 0078 4033     		adds	r3, r3, #64
 132 007a 9B00     		lsls	r3, r3, #2
 133 007c 0B44     		add	r3, r3, r1
 134 007e 5A60     		str	r2, [r3, #4]
 135              	.L3:
 101:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   }
 102:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 103:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   return HAL_OK;
 136              		.loc 1 103 10
 137 0080 0023     		movs	r3, #0
 104:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** }
 138              		.loc 1 104 1
 139 0082 1846     		mov	r0, r3
 140 0084 1437     		adds	r7, r7, #20
 141              	.LCFI3:
 142              		.cfi_def_cfa_offset 4
 143 0086 BD46     		mov	sp, r7
 144              	.LCFI4:
 145              		.cfi_def_cfa_register 13
 146              		@ sp needed
 147 0088 5DF8047B 		ldr	r7, [sp], #4
 148              	.LCFI5:
 149              		.cfi_restore 7
 150              		.cfi_def_cfa_offset 0
 151 008c 7047     		bx	lr
 152              		.cfi_endproc
 153              	.LFE144:
 155              		.section	.text.HAL_PCDEx_SetRxFiFo,"ax",%progbits
 156              		.align	1
 157              		.global	HAL_PCDEx_SetRxFiFo
 158              		.syntax unified
 159              		.thumb
 160              		.thumb_func
 162              	HAL_PCDEx_SetRxFiFo:
 163              	.LFB145:
 105:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 106:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
 107:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief  Set Rx FIFO
 108:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  hpcd PCD handle
 109:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  size Size of Rx fifo
 110:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @retval HAL status
 111:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
 112:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** HAL_StatusTypeDef HAL_PCDEx_SetRxFiFo(PCD_HandleTypeDef *hpcd, uint16_t size)
 113:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** {
 164              		.loc 1 113 1
 165              		.cfi_startproc
 166              		@ args = 0, pretend = 0, frame = 8
 167              		@ frame_needed = 1, uses_anonymous_args = 0
 168              		@ link register save eliminated.
 169 0000 80B4     		push	{r7}
 170              	.LCFI6:
 171              		.cfi_def_cfa_offset 4
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 6


 172              		.cfi_offset 7, -4
 173 0002 83B0     		sub	sp, sp, #12
 174              	.LCFI7:
 175              		.cfi_def_cfa_offset 16
 176 0004 00AF     		add	r7, sp, #0
 177              	.LCFI8:
 178              		.cfi_def_cfa_register 7
 179 0006 7860     		str	r0, [r7, #4]
 180 0008 0B46     		mov	r3, r1
 181 000a 7B80     		strh	r3, [r7, #2]	@ movhi
 114:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   hpcd->Instance->GRXFSIZ = size;
 182              		.loc 1 114 7
 183 000c 7B68     		ldr	r3, [r7, #4]
 184 000e 1B68     		ldr	r3, [r3]
 185              		.loc 1 114 27
 186 0010 7A88     		ldrh	r2, [r7, #2]
 187 0012 5A62     		str	r2, [r3, #36]
 115:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 116:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   return HAL_OK;
 188              		.loc 1 116 10
 189 0014 0023     		movs	r3, #0
 117:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** }
 190              		.loc 1 117 1
 191 0016 1846     		mov	r0, r3
 192 0018 0C37     		adds	r7, r7, #12
 193              	.LCFI9:
 194              		.cfi_def_cfa_offset 4
 195 001a BD46     		mov	sp, r7
 196              	.LCFI10:
 197              		.cfi_def_cfa_register 13
 198              		@ sp needed
 199 001c 5DF8047B 		ldr	r7, [sp], #4
 200              	.LCFI11:
 201              		.cfi_restore 7
 202              		.cfi_def_cfa_offset 0
 203 0020 7047     		bx	lr
 204              		.cfi_endproc
 205              	.LFE145:
 207              		.section	.text.HAL_PCDEx_ActivateLPM,"ax",%progbits
 208              		.align	1
 209              		.global	HAL_PCDEx_ActivateLPM
 210              		.syntax unified
 211              		.thumb
 212              		.thumb_func
 214              	HAL_PCDEx_ActivateLPM:
 215              	.LFB146:
 118:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 119:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
 120:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief  Activate LPM feature.
 121:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  hpcd PCD handle
 122:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @retval HAL status
 123:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
 124:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** HAL_StatusTypeDef HAL_PCDEx_ActivateLPM(PCD_HandleTypeDef *hpcd)
 125:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** {
 216              		.loc 1 125 1
 217              		.cfi_startproc
 218              		@ args = 0, pretend = 0, frame = 16
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 7


 219              		@ frame_needed = 1, uses_anonymous_args = 0
 220              		@ link register save eliminated.
 221 0000 80B4     		push	{r7}
 222              	.LCFI12:
 223              		.cfi_def_cfa_offset 4
 224              		.cfi_offset 7, -4
 225 0002 85B0     		sub	sp, sp, #20
 226              	.LCFI13:
 227              		.cfi_def_cfa_offset 24
 228 0004 00AF     		add	r7, sp, #0
 229              	.LCFI14:
 230              		.cfi_def_cfa_register 7
 231 0006 7860     		str	r0, [r7, #4]
 126:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USB_OTG_GlobalTypeDef *USBx = hpcd->Instance;
 232              		.loc 1 126 26
 233 0008 7B68     		ldr	r3, [r7, #4]
 234 000a 1B68     		ldr	r3, [r3]
 235 000c FB60     		str	r3, [r7, #12]
 127:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 128:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   hpcd->lpm_active = 1U;
 236              		.loc 1 128 20
 237 000e 7B68     		ldr	r3, [r7, #4]
 238 0010 0122     		movs	r2, #1
 239 0012 C3F80025 		str	r2, [r3, #1280]
 129:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   hpcd->LPM_State = LPM_L0;
 240              		.loc 1 129 19
 241 0016 7B68     		ldr	r3, [r7, #4]
 242 0018 0022     		movs	r2, #0
 243 001a 83F8F424 		strb	r2, [r3, #1268]
 130:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GINTMSK |= USB_OTG_GINTMSK_LPMINTM;
 244              		.loc 1 130 17
 245 001e FB68     		ldr	r3, [r7, #12]
 246 0020 9B69     		ldr	r3, [r3, #24]
 247 0022 43F00062 		orr	r2, r3, #134217728
 248 0026 FB68     		ldr	r3, [r7, #12]
 249 0028 9A61     		str	r2, [r3, #24]
 131:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GLPMCFG |= (USB_OTG_GLPMCFG_LPMEN | USB_OTG_GLPMCFG_LPMACK | USB_OTG_GLPMCFG_ENBESL);
 250              		.loc 1 131 17
 251 002a FB68     		ldr	r3, [r7, #12]
 252 002c 5A6D     		ldr	r2, [r3, #84]
 253 002e 054B     		ldr	r3, .L11
 254 0030 1343     		orrs	r3, r3, r2
 255 0032 FA68     		ldr	r2, [r7, #12]
 256 0034 5365     		str	r3, [r2, #84]
 132:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 133:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   return HAL_OK;
 257              		.loc 1 133 10
 258 0036 0023     		movs	r3, #0
 134:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** }
 259              		.loc 1 134 1
 260 0038 1846     		mov	r0, r3
 261 003a 1437     		adds	r7, r7, #20
 262              	.LCFI15:
 263              		.cfi_def_cfa_offset 4
 264 003c BD46     		mov	sp, r7
 265              	.LCFI16:
 266              		.cfi_def_cfa_register 13
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 8


 267              		@ sp needed
 268 003e 5DF8047B 		ldr	r7, [sp], #4
 269              	.LCFI17:
 270              		.cfi_restore 7
 271              		.cfi_def_cfa_offset 0
 272 0042 7047     		bx	lr
 273              	.L12:
 274              		.align	2
 275              	.L11:
 276 0044 03000010 		.word	268435459
 277              		.cfi_endproc
 278              	.LFE146:
 280              		.section	.text.HAL_PCDEx_DeActivateLPM,"ax",%progbits
 281              		.align	1
 282              		.global	HAL_PCDEx_DeActivateLPM
 283              		.syntax unified
 284              		.thumb
 285              		.thumb_func
 287              	HAL_PCDEx_DeActivateLPM:
 288              	.LFB147:
 135:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 136:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
 137:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief  Deactivate LPM feature.
 138:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  hpcd PCD handle
 139:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @retval HAL status
 140:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
 141:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** HAL_StatusTypeDef HAL_PCDEx_DeActivateLPM(PCD_HandleTypeDef *hpcd)
 142:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** {
 289              		.loc 1 142 1
 290              		.cfi_startproc
 291              		@ args = 0, pretend = 0, frame = 16
 292              		@ frame_needed = 1, uses_anonymous_args = 0
 293              		@ link register save eliminated.
 294 0000 80B4     		push	{r7}
 295              	.LCFI18:
 296              		.cfi_def_cfa_offset 4
 297              		.cfi_offset 7, -4
 298 0002 85B0     		sub	sp, sp, #20
 299              	.LCFI19:
 300              		.cfi_def_cfa_offset 24
 301 0004 00AF     		add	r7, sp, #0
 302              	.LCFI20:
 303              		.cfi_def_cfa_register 7
 304 0006 7860     		str	r0, [r7, #4]
 143:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USB_OTG_GlobalTypeDef *USBx = hpcd->Instance;
 305              		.loc 1 143 26
 306 0008 7B68     		ldr	r3, [r7, #4]
 307 000a 1B68     		ldr	r3, [r3]
 308 000c FB60     		str	r3, [r7, #12]
 144:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 145:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   hpcd->lpm_active = 0U;
 309              		.loc 1 145 20
 310 000e 7B68     		ldr	r3, [r7, #4]
 311 0010 0022     		movs	r2, #0
 312 0012 C3F80025 		str	r2, [r3, #1280]
 146:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GINTMSK &= ~USB_OTG_GINTMSK_LPMINTM;
 313              		.loc 1 146 17
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 9


 314 0016 FB68     		ldr	r3, [r7, #12]
 315 0018 9B69     		ldr	r3, [r3, #24]
 316 001a 23F00062 		bic	r2, r3, #134217728
 317 001e FB68     		ldr	r3, [r7, #12]
 318 0020 9A61     		str	r2, [r3, #24]
 147:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GLPMCFG &= ~(USB_OTG_GLPMCFG_LPMEN | USB_OTG_GLPMCFG_LPMACK | USB_OTG_GLPMCFG_ENBESL);
 319              		.loc 1 147 17
 320 0022 FB68     		ldr	r3, [r7, #12]
 321 0024 5A6D     		ldr	r2, [r3, #84]
 322 0026 054B     		ldr	r3, .L15
 323 0028 1340     		ands	r3, r3, r2
 324 002a FA68     		ldr	r2, [r7, #12]
 325 002c 5365     		str	r3, [r2, #84]
 148:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 149:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   return HAL_OK;
 326              		.loc 1 149 10
 327 002e 0023     		movs	r3, #0
 150:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** }
 328              		.loc 1 150 1
 329 0030 1846     		mov	r0, r3
 330 0032 1437     		adds	r7, r7, #20
 331              	.LCFI21:
 332              		.cfi_def_cfa_offset 4
 333 0034 BD46     		mov	sp, r7
 334              	.LCFI22:
 335              		.cfi_def_cfa_register 13
 336              		@ sp needed
 337 0036 5DF8047B 		ldr	r7, [sp], #4
 338              	.LCFI23:
 339              		.cfi_restore 7
 340              		.cfi_def_cfa_offset 0
 341 003a 7047     		bx	lr
 342              	.L16:
 343              		.align	2
 344              	.L15:
 345 003c FCFFFFEF 		.word	-268435460
 346              		.cfi_endproc
 347              	.LFE147:
 349              		.section	.text.HAL_PCDEx_BCD_VBUSDetect,"ax",%progbits
 350              		.align	1
 351              		.global	HAL_PCDEx_BCD_VBUSDetect
 352              		.syntax unified
 353              		.thumb
 354              		.thumb_func
 356              	HAL_PCDEx_BCD_VBUSDetect:
 357              	.LFB148:
 151:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 152:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 153:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
 154:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief  Handle BatteryCharging Process.
 155:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  hpcd PCD handle
 156:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @retval HAL status
 157:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
 158:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** void HAL_PCDEx_BCD_VBUSDetect(PCD_HandleTypeDef *hpcd)
 159:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** {
 358              		.loc 1 159 1
 359              		.cfi_startproc
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 10


 360              		@ args = 0, pretend = 0, frame = 16
 361              		@ frame_needed = 1, uses_anonymous_args = 0
 362 0000 80B5     		push	{r7, lr}
 363              	.LCFI24:
 364              		.cfi_def_cfa_offset 8
 365              		.cfi_offset 7, -8
 366              		.cfi_offset 14, -4
 367 0002 84B0     		sub	sp, sp, #16
 368              	.LCFI25:
 369              		.cfi_def_cfa_offset 24
 370 0004 00AF     		add	r7, sp, #0
 371              	.LCFI26:
 372              		.cfi_def_cfa_register 7
 373 0006 7860     		str	r0, [r7, #4]
 160:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USB_OTG_GlobalTypeDef *USBx = hpcd->Instance;
 374              		.loc 1 160 26
 375 0008 7B68     		ldr	r3, [r7, #4]
 376 000a 1B68     		ldr	r3, [r3]
 377 000c FB60     		str	r3, [r7, #12]
 161:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   uint32_t tickstart = HAL_GetTick();
 378              		.loc 1 161 24
 379 000e FFF7FEFF 		bl	HAL_GetTick
 380 0012 B860     		str	r0, [r7, #8]
 162:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 163:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Enable DCD : Data Contact Detect */
 164:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG |= USB_OTG_GCCFG_DCDEN;
 381              		.loc 1 164 15
 382 0014 FB68     		ldr	r3, [r7, #12]
 383 0016 9B6B     		ldr	r3, [r3, #56]
 384 0018 43F48022 		orr	r2, r3, #262144
 385 001c FB68     		ldr	r3, [r7, #12]
 386 001e 9A63     		str	r2, [r3, #56]
 165:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 166:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Wait for Min DCD Timeout */
 167:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   HAL_Delay(300U);
 387              		.loc 1 167 3
 388 0020 4FF49670 		mov	r0, #300
 389 0024 FFF7FEFF 		bl	HAL_Delay
 168:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 169:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Check Detect flag */
 170:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   if ((USBx->GCCFG & USB_OTG_GCCFG_DCDET) == USB_OTG_GCCFG_DCDET)
 390              		.loc 1 170 12
 391 0028 FB68     		ldr	r3, [r7, #12]
 392 002a 9B6B     		ldr	r3, [r3, #56]
 393              		.loc 1 170 20
 394 002c 03F00103 		and	r3, r3, #1
 395              		.loc 1 170 6
 396 0030 012B     		cmp	r3, #1
 397 0032 03D1     		bne	.L18
 171:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   {
 172:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #if (USE_HAL_PCD_REGISTER_CALLBACKS == 1U)
 173:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     hpcd->BCDCallback(hpcd, PCD_BCD_CONTACT_DETECTION);
 174:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #else
 175:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     HAL_PCDEx_BCD_Callback(hpcd, PCD_BCD_CONTACT_DETECTION);
 398              		.loc 1 175 5
 399 0034 FE21     		movs	r1, #254
 400 0036 7868     		ldr	r0, [r7, #4]
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 11


 401 0038 FFF7FEFF 		bl	HAL_PCDEx_BCD_Callback
 402              	.L18:
 176:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #endif /* USE_HAL_PCD_REGISTER_CALLBACKS */
 177:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   }
 178:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 179:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Primary detection: checks if connected to Standard Downstream Port
 180:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   (without charging capability) */
 181:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG &= ~ USB_OTG_GCCFG_DCDEN;
 403              		.loc 1 181 15
 404 003c FB68     		ldr	r3, [r7, #12]
 405 003e 9B6B     		ldr	r3, [r3, #56]
 406 0040 23F48022 		bic	r2, r3, #262144
 407 0044 FB68     		ldr	r3, [r7, #12]
 408 0046 9A63     		str	r2, [r3, #56]
 182:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   HAL_Delay(50U);
 409              		.loc 1 182 3
 410 0048 3220     		movs	r0, #50
 411 004a FFF7FEFF 		bl	HAL_Delay
 183:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG |=  USB_OTG_GCCFG_PDEN;
 412              		.loc 1 183 15
 413 004e FB68     		ldr	r3, [r7, #12]
 414 0050 9B6B     		ldr	r3, [r3, #56]
 415 0052 43F40022 		orr	r2, r3, #524288
 416 0056 FB68     		ldr	r3, [r7, #12]
 417 0058 9A63     		str	r2, [r3, #56]
 184:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   HAL_Delay(50U);
 418              		.loc 1 184 3
 419 005a 3220     		movs	r0, #50
 420 005c FFF7FEFF 		bl	HAL_Delay
 185:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 186:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   if ((USBx->GCCFG & USB_OTG_GCCFG_PDET) == 0U)
 421              		.loc 1 186 12
 422 0060 FB68     		ldr	r3, [r7, #12]
 423 0062 9B6B     		ldr	r3, [r3, #56]
 424              		.loc 1 186 20
 425 0064 03F00203 		and	r3, r3, #2
 426              		.loc 1 186 6
 427 0068 002B     		cmp	r3, #0
 428 006a 04D1     		bne	.L19
 187:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   {
 188:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     /* Case of Standard Downstream Port */
 189:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #if (USE_HAL_PCD_REGISTER_CALLBACKS == 1U)
 190:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     hpcd->BCDCallback(hpcd, PCD_BCD_STD_DOWNSTREAM_PORT);
 191:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #else
 192:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     HAL_PCDEx_BCD_Callback(hpcd, PCD_BCD_STD_DOWNSTREAM_PORT);
 429              		.loc 1 192 5
 430 006c FD21     		movs	r1, #253
 431 006e 7868     		ldr	r0, [r7, #4]
 432 0070 FFF7FEFF 		bl	HAL_PCDEx_BCD_Callback
 433 0074 20E0     		b	.L20
 434              	.L19:
 193:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #endif /* USE_HAL_PCD_REGISTER_CALLBACKS */
 194:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   }
 195:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   else
 196:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   {
 197:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     /* start secondary detection to check connection to Charging Downstream
 198:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     Port or Dedicated Charging Port */
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 12


 199:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     USBx->GCCFG &= ~ USB_OTG_GCCFG_PDEN;
 435              		.loc 1 199 17
 436 0076 FB68     		ldr	r3, [r7, #12]
 437 0078 9B6B     		ldr	r3, [r3, #56]
 438 007a 23F40022 		bic	r2, r3, #524288
 439 007e FB68     		ldr	r3, [r7, #12]
 440 0080 9A63     		str	r2, [r3, #56]
 200:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     HAL_Delay(50U);
 441              		.loc 1 200 5
 442 0082 3220     		movs	r0, #50
 443 0084 FFF7FEFF 		bl	HAL_Delay
 201:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     USBx->GCCFG |=  USB_OTG_GCCFG_SDEN;
 444              		.loc 1 201 17
 445 0088 FB68     		ldr	r3, [r7, #12]
 446 008a 9B6B     		ldr	r3, [r3, #56]
 447 008c 43F48012 		orr	r2, r3, #1048576
 448 0090 FB68     		ldr	r3, [r7, #12]
 449 0092 9A63     		str	r2, [r3, #56]
 202:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     HAL_Delay(50U);
 450              		.loc 1 202 5
 451 0094 3220     		movs	r0, #50
 452 0096 FFF7FEFF 		bl	HAL_Delay
 203:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 204:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     if ((USBx->GCCFG & USB_OTG_GCCFG_SDET) == USB_OTG_GCCFG_SDET)
 453              		.loc 1 204 14
 454 009a FB68     		ldr	r3, [r7, #12]
 455 009c 9B6B     		ldr	r3, [r3, #56]
 456              		.loc 1 204 22
 457 009e 03F00403 		and	r3, r3, #4
 458              		.loc 1 204 8
 459 00a2 042B     		cmp	r3, #4
 460 00a4 04D1     		bne	.L21
 205:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     {
 206:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****       /* case Dedicated Charging Port  */
 207:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #if (USE_HAL_PCD_REGISTER_CALLBACKS == 1U)
 208:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****       hpcd->BCDCallback(hpcd, PCD_BCD_DEDICATED_CHARGING_PORT);
 209:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #else
 210:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****       HAL_PCDEx_BCD_Callback(hpcd, PCD_BCD_DEDICATED_CHARGING_PORT);
 461              		.loc 1 210 7
 462 00a6 FB21     		movs	r1, #251
 463 00a8 7868     		ldr	r0, [r7, #4]
 464 00aa FFF7FEFF 		bl	HAL_PCDEx_BCD_Callback
 465 00ae 03E0     		b	.L20
 466              	.L21:
 211:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #endif /* USE_HAL_PCD_REGISTER_CALLBACKS */
 212:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     }
 213:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     else
 214:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     {
 215:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****       /* case Charging Downstream Port */
 216:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #if (USE_HAL_PCD_REGISTER_CALLBACKS == 1U)
 217:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****       hpcd->BCDCallback(hpcd, PCD_BCD_CHARGING_DOWNSTREAM_PORT);
 218:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #else
 219:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****       HAL_PCDEx_BCD_Callback(hpcd, PCD_BCD_CHARGING_DOWNSTREAM_PORT);
 467              		.loc 1 219 7
 468 00b0 FC21     		movs	r1, #252
 469 00b2 7868     		ldr	r0, [r7, #4]
 470 00b4 FFF7FEFF 		bl	HAL_PCDEx_BCD_Callback
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 13


 471              	.L20:
 220:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #endif /* USE_HAL_PCD_REGISTER_CALLBACKS */
 221:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     }
 222:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   }
 223:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 224:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Battery Charging capability discovery finished */
 225:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   (void)HAL_PCDEx_DeActivateBCD(hpcd);
 472              		.loc 1 225 9
 473 00b8 7868     		ldr	r0, [r7, #4]
 474 00ba FFF7FEFF 		bl	HAL_PCDEx_DeActivateBCD
 226:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 227:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Check for the Timeout, else start USB Device */
 228:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   if ((HAL_GetTick() - tickstart) > 1000U)
 475              		.loc 1 228 8
 476 00be FFF7FEFF 		bl	HAL_GetTick
 477 00c2 0246     		mov	r2, r0
 478              		.loc 1 228 22
 479 00c4 BB68     		ldr	r3, [r7, #8]
 480 00c6 D31A     		subs	r3, r2, r3
 481              		.loc 1 228 6
 482 00c8 B3F57A7F 		cmp	r3, #1000
 483 00cc 04D9     		bls	.L22
 229:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   {
 230:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #if (USE_HAL_PCD_REGISTER_CALLBACKS == 1U)
 231:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     hpcd->BCDCallback(hpcd, PCD_BCD_ERROR);
 232:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #else
 233:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     HAL_PCDEx_BCD_Callback(hpcd, PCD_BCD_ERROR);
 484              		.loc 1 233 5
 485 00ce FF21     		movs	r1, #255
 486 00d0 7868     		ldr	r0, [r7, #4]
 487 00d2 FFF7FEFF 		bl	HAL_PCDEx_BCD_Callback
 234:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #endif /* USE_HAL_PCD_REGISTER_CALLBACKS */
 235:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   }
 236:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   else
 237:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   {
 238:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #if (USE_HAL_PCD_REGISTER_CALLBACKS == 1U)
 239:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     hpcd->BCDCallback(hpcd, PCD_BCD_DISCOVERY_COMPLETED);
 240:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #else
 241:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****     HAL_PCDEx_BCD_Callback(hpcd, PCD_BCD_DISCOVERY_COMPLETED);
 242:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #endif /* USE_HAL_PCD_REGISTER_CALLBACKS */
 243:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   }
 244:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** }
 488              		.loc 1 244 1
 489 00d6 03E0     		b	.L24
 490              	.L22:
 241:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #endif /* USE_HAL_PCD_REGISTER_CALLBACKS */
 491              		.loc 1 241 5
 492 00d8 0021     		movs	r1, #0
 493 00da 7868     		ldr	r0, [r7, #4]
 494 00dc FFF7FEFF 		bl	HAL_PCDEx_BCD_Callback
 495              	.L24:
 496              		.loc 1 244 1
 497 00e0 00BF     		nop
 498 00e2 1037     		adds	r7, r7, #16
 499              	.LCFI27:
 500              		.cfi_def_cfa_offset 8
 501 00e4 BD46     		mov	sp, r7
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 14


 502              	.LCFI28:
 503              		.cfi_def_cfa_register 13
 504              		@ sp needed
 505 00e6 80BD     		pop	{r7, pc}
 506              		.cfi_endproc
 507              	.LFE148:
 509              		.section	.text.HAL_PCDEx_ActivateBCD,"ax",%progbits
 510              		.align	1
 511              		.global	HAL_PCDEx_ActivateBCD
 512              		.syntax unified
 513              		.thumb
 514              		.thumb_func
 516              	HAL_PCDEx_ActivateBCD:
 517              	.LFB149:
 245:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 246:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
 247:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief  Activate BatteryCharging feature.
 248:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  hpcd PCD handle
 249:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @retval HAL status
 250:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
 251:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** HAL_StatusTypeDef HAL_PCDEx_ActivateBCD(PCD_HandleTypeDef *hpcd)
 252:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** {
 518              		.loc 1 252 1
 519              		.cfi_startproc
 520              		@ args = 0, pretend = 0, frame = 16
 521              		@ frame_needed = 1, uses_anonymous_args = 0
 522              		@ link register save eliminated.
 523 0000 80B4     		push	{r7}
 524              	.LCFI29:
 525              		.cfi_def_cfa_offset 4
 526              		.cfi_offset 7, -4
 527 0002 85B0     		sub	sp, sp, #20
 528              	.LCFI30:
 529              		.cfi_def_cfa_offset 24
 530 0004 00AF     		add	r7, sp, #0
 531              	.LCFI31:
 532              		.cfi_def_cfa_register 7
 533 0006 7860     		str	r0, [r7, #4]
 253:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USB_OTG_GlobalTypeDef *USBx = hpcd->Instance;
 534              		.loc 1 253 26
 535 0008 7B68     		ldr	r3, [r7, #4]
 536 000a 1B68     		ldr	r3, [r3]
 537 000c FB60     		str	r3, [r7, #12]
 254:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 255:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG &= ~(USB_OTG_GCCFG_PDEN);
 538              		.loc 1 255 15
 539 000e FB68     		ldr	r3, [r7, #12]
 540 0010 9B6B     		ldr	r3, [r3, #56]
 541 0012 23F40022 		bic	r2, r3, #524288
 542 0016 FB68     		ldr	r3, [r7, #12]
 543 0018 9A63     		str	r2, [r3, #56]
 256:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG &= ~(USB_OTG_GCCFG_SDEN);
 544              		.loc 1 256 15
 545 001a FB68     		ldr	r3, [r7, #12]
 546 001c 9B6B     		ldr	r3, [r3, #56]
 547 001e 23F48012 		bic	r2, r3, #1048576
 548 0022 FB68     		ldr	r3, [r7, #12]
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 15


 549 0024 9A63     		str	r2, [r3, #56]
 257:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 258:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Power Down USB transceiver  */
 259:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG &= ~(USB_OTG_GCCFG_PWRDWN);
 550              		.loc 1 259 15
 551 0026 FB68     		ldr	r3, [r7, #12]
 552 0028 9B6B     		ldr	r3, [r3, #56]
 553 002a 23F48032 		bic	r2, r3, #65536
 554 002e FB68     		ldr	r3, [r7, #12]
 555 0030 9A63     		str	r2, [r3, #56]
 260:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 261:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Enable Battery charging */
 262:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG |= USB_OTG_GCCFG_BCDEN;
 556              		.loc 1 262 15
 557 0032 FB68     		ldr	r3, [r7, #12]
 558 0034 9B6B     		ldr	r3, [r3, #56]
 559 0036 43F40032 		orr	r2, r3, #131072
 560 003a FB68     		ldr	r3, [r7, #12]
 561 003c 9A63     		str	r2, [r3, #56]
 263:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 264:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   hpcd->battery_charging_active = 1U;
 562              		.loc 1 264 33
 563 003e 7B68     		ldr	r3, [r7, #4]
 564 0040 0122     		movs	r2, #1
 565 0042 C3F80425 		str	r2, [r3, #1284]
 265:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 266:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   return HAL_OK;
 566              		.loc 1 266 10
 567 0046 0023     		movs	r3, #0
 267:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** }
 568              		.loc 1 267 1
 569 0048 1846     		mov	r0, r3
 570 004a 1437     		adds	r7, r7, #20
 571              	.LCFI32:
 572              		.cfi_def_cfa_offset 4
 573 004c BD46     		mov	sp, r7
 574              	.LCFI33:
 575              		.cfi_def_cfa_register 13
 576              		@ sp needed
 577 004e 5DF8047B 		ldr	r7, [sp], #4
 578              	.LCFI34:
 579              		.cfi_restore 7
 580              		.cfi_def_cfa_offset 0
 581 0052 7047     		bx	lr
 582              		.cfi_endproc
 583              	.LFE149:
 585              		.section	.text.HAL_PCDEx_DeActivateBCD,"ax",%progbits
 586              		.align	1
 587              		.global	HAL_PCDEx_DeActivateBCD
 588              		.syntax unified
 589              		.thumb
 590              		.thumb_func
 592              	HAL_PCDEx_DeActivateBCD:
 593              	.LFB150:
 268:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 269:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
 270:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief  Deactivate BatteryCharging feature.
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 16


 271:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  hpcd PCD handle
 272:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @retval HAL status
 273:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
 274:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** HAL_StatusTypeDef HAL_PCDEx_DeActivateBCD(PCD_HandleTypeDef *hpcd)
 275:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** {
 594              		.loc 1 275 1
 595              		.cfi_startproc
 596              		@ args = 0, pretend = 0, frame = 16
 597              		@ frame_needed = 1, uses_anonymous_args = 0
 598              		@ link register save eliminated.
 599 0000 80B4     		push	{r7}
 600              	.LCFI35:
 601              		.cfi_def_cfa_offset 4
 602              		.cfi_offset 7, -4
 603 0002 85B0     		sub	sp, sp, #20
 604              	.LCFI36:
 605              		.cfi_def_cfa_offset 24
 606 0004 00AF     		add	r7, sp, #0
 607              	.LCFI37:
 608              		.cfi_def_cfa_register 7
 609 0006 7860     		str	r0, [r7, #4]
 276:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USB_OTG_GlobalTypeDef *USBx = hpcd->Instance;
 610              		.loc 1 276 26
 611 0008 7B68     		ldr	r3, [r7, #4]
 612 000a 1B68     		ldr	r3, [r3]
 613 000c FB60     		str	r3, [r7, #12]
 277:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 278:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG &= ~(USB_OTG_GCCFG_SDEN);
 614              		.loc 1 278 15
 615 000e FB68     		ldr	r3, [r7, #12]
 616 0010 9B6B     		ldr	r3, [r3, #56]
 617 0012 23F48012 		bic	r2, r3, #1048576
 618 0016 FB68     		ldr	r3, [r7, #12]
 619 0018 9A63     		str	r2, [r3, #56]
 279:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG &= ~(USB_OTG_GCCFG_PDEN);
 620              		.loc 1 279 15
 621 001a FB68     		ldr	r3, [r7, #12]
 622 001c 9B6B     		ldr	r3, [r3, #56]
 623 001e 23F40022 		bic	r2, r3, #524288
 624 0022 FB68     		ldr	r3, [r7, #12]
 625 0024 9A63     		str	r2, [r3, #56]
 280:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 281:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Disable Battery charging */
 282:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   USBx->GCCFG &= ~(USB_OTG_GCCFG_BCDEN);
 626              		.loc 1 282 15
 627 0026 FB68     		ldr	r3, [r7, #12]
 628 0028 9B6B     		ldr	r3, [r3, #56]
 629 002a 23F40032 		bic	r2, r3, #131072
 630 002e FB68     		ldr	r3, [r7, #12]
 631 0030 9A63     		str	r2, [r3, #56]
 283:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 284:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   hpcd->battery_charging_active = 0U;
 632              		.loc 1 284 33
 633 0032 7B68     		ldr	r3, [r7, #4]
 634 0034 0022     		movs	r2, #0
 635 0036 C3F80425 		str	r2, [r3, #1284]
 285:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 17


 286:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   return HAL_OK;
 636              		.loc 1 286 10
 637 003a 0023     		movs	r3, #0
 287:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** }
 638              		.loc 1 287 1
 639 003c 1846     		mov	r0, r3
 640 003e 1437     		adds	r7, r7, #20
 641              	.LCFI38:
 642              		.cfi_def_cfa_offset 4
 643 0040 BD46     		mov	sp, r7
 644              	.LCFI39:
 645              		.cfi_def_cfa_register 13
 646              		@ sp needed
 647 0042 5DF8047B 		ldr	r7, [sp], #4
 648              	.LCFI40:
 649              		.cfi_restore 7
 650              		.cfi_def_cfa_offset 0
 651 0046 7047     		bx	lr
 652              		.cfi_endproc
 653              	.LFE150:
 655              		.section	.text.HAL_PCDEx_LPM_Callback,"ax",%progbits
 656              		.align	1
 657              		.weak	HAL_PCDEx_LPM_Callback
 658              		.syntax unified
 659              		.thumb
 660              		.thumb_func
 662              	HAL_PCDEx_LPM_Callback:
 663              	.LFB151:
 288:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 289:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** #endif /* defined (USB_OTG_FS) || defined (USB_OTG_HS) */
 290:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 291:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
 292:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief  Send LPM message to user layer callback.
 293:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  hpcd PCD handle
 294:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  msg LPM message
 295:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @retval HAL status
 296:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
 297:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** __weak void HAL_PCDEx_LPM_Callback(PCD_HandleTypeDef *hpcd, PCD_LPM_MsgTypeDef msg)
 298:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** {
 664              		.loc 1 298 1
 665              		.cfi_startproc
 666              		@ args = 0, pretend = 0, frame = 8
 667              		@ frame_needed = 1, uses_anonymous_args = 0
 668              		@ link register save eliminated.
 669 0000 80B4     		push	{r7}
 670              	.LCFI41:
 671              		.cfi_def_cfa_offset 4
 672              		.cfi_offset 7, -4
 673 0002 83B0     		sub	sp, sp, #12
 674              	.LCFI42:
 675              		.cfi_def_cfa_offset 16
 676 0004 00AF     		add	r7, sp, #0
 677              	.LCFI43:
 678              		.cfi_def_cfa_register 7
 679 0006 7860     		str	r0, [r7, #4]
 680 0008 0B46     		mov	r3, r1
 681 000a FB70     		strb	r3, [r7, #3]
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 18


 299:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Prevent unused argument(s) compilation warning */
 300:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   UNUSED(hpcd);
 301:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   UNUSED(msg);
 302:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 303:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* NOTE : This function should not be modified, when the callback is needed,
 304:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****             the HAL_PCDEx_LPM_Callback could be implemented in the user file
 305:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****    */
 306:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** }
 682              		.loc 1 306 1
 683 000c 00BF     		nop
 684 000e 0C37     		adds	r7, r7, #12
 685              	.LCFI44:
 686              		.cfi_def_cfa_offset 4
 687 0010 BD46     		mov	sp, r7
 688              	.LCFI45:
 689              		.cfi_def_cfa_register 13
 690              		@ sp needed
 691 0012 5DF8047B 		ldr	r7, [sp], #4
 692              	.LCFI46:
 693              		.cfi_restore 7
 694              		.cfi_def_cfa_offset 0
 695 0016 7047     		bx	lr
 696              		.cfi_endproc
 697              	.LFE151:
 699              		.section	.text.HAL_PCDEx_BCD_Callback,"ax",%progbits
 700              		.align	1
 701              		.weak	HAL_PCDEx_BCD_Callback
 702              		.syntax unified
 703              		.thumb
 704              		.thumb_func
 706              	HAL_PCDEx_BCD_Callback:
 707              	.LFB152:
 307:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 308:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** /**
 309:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @brief  Send BatteryCharging message to user layer callback.
 310:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  hpcd PCD handle
 311:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @param  msg LPM message
 312:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   * @retval HAL status
 313:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   */
 314:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** __weak void HAL_PCDEx_BCD_Callback(PCD_HandleTypeDef *hpcd, PCD_BCD_MsgTypeDef msg)
 315:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** {
 708              		.loc 1 315 1
 709              		.cfi_startproc
 710              		@ args = 0, pretend = 0, frame = 8
 711              		@ frame_needed = 1, uses_anonymous_args = 0
 712              		@ link register save eliminated.
 713 0000 80B4     		push	{r7}
 714              	.LCFI47:
 715              		.cfi_def_cfa_offset 4
 716              		.cfi_offset 7, -4
 717 0002 83B0     		sub	sp, sp, #12
 718              	.LCFI48:
 719              		.cfi_def_cfa_offset 16
 720 0004 00AF     		add	r7, sp, #0
 721              	.LCFI49:
 722              		.cfi_def_cfa_register 7
 723 0006 7860     		str	r0, [r7, #4]
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 19


 724 0008 0B46     		mov	r3, r1
 725 000a FB70     		strb	r3, [r7, #3]
 316:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* Prevent unused argument(s) compilation warning */
 317:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   UNUSED(hpcd);
 318:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   UNUSED(msg);
 319:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** 
 320:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****   /* NOTE : This function should not be modified, when the callback is needed,
 321:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****             the HAL_PCDEx_BCD_Callback could be implemented in the user file
 322:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c ****    */
 323:Drivers/STM32H7xx_HAL_Driver/Src/stm32h7xx_hal_pcd_ex.c **** }
 726              		.loc 1 323 1
 727 000c 00BF     		nop
 728 000e 0C37     		adds	r7, r7, #12
 729              	.LCFI50:
 730              		.cfi_def_cfa_offset 4
 731 0010 BD46     		mov	sp, r7
 732              	.LCFI51:
 733              		.cfi_def_cfa_register 13
 734              		@ sp needed
 735 0012 5DF8047B 		ldr	r7, [sp], #4
 736              	.LCFI52:
 737              		.cfi_restore 7
 738              		.cfi_def_cfa_offset 0
 739 0016 7047     		bx	lr
 740              		.cfi_endproc
 741              	.LFE152:
 743              		.text
 744              	.Letext0:
 745              		.file 2 "e:\\user\\bigai\\gcc_arm_none_eabi\\arm-none-eabi\\include\\machine\\_default_types.h"
 746              		.file 3 "e:\\user\\bigai\\gcc_arm_none_eabi\\arm-none-eabi\\include\\sys\\_stdint.h"
 747              		.file 4 "Drivers/CMSIS/Device/ST/STM32H7xx/Include/stm32h723xx.h"
 748              		.file 5 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_def.h"
 749              		.file 6 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_ll_usb.h"
 750              		.file 7 "Drivers/STM32H7xx_HAL_Driver/Inc/stm32h7xx_hal_pcd.h"
ARM GAS  C:\Users\Su\AppData\Local\Temp\ccDPELKY.s 			page 20


DEFINED SYMBOLS
                            *ABS*:00000000 stm32h7xx_hal_pcd_ex.c
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:19     .text.HAL_PCDEx_SetTxFiFo:00000000 $t
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:25     .text.HAL_PCDEx_SetTxFiFo:00000000 HAL_PCDEx_SetTxFiFo
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:156    .text.HAL_PCDEx_SetRxFiFo:00000000 $t
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:162    .text.HAL_PCDEx_SetRxFiFo:00000000 HAL_PCDEx_SetRxFiFo
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:208    .text.HAL_PCDEx_ActivateLPM:00000000 $t
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:214    .text.HAL_PCDEx_ActivateLPM:00000000 HAL_PCDEx_ActivateLPM
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:276    .text.HAL_PCDEx_ActivateLPM:00000044 $d
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:281    .text.HAL_PCDEx_DeActivateLPM:00000000 $t
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:287    .text.HAL_PCDEx_DeActivateLPM:00000000 HAL_PCDEx_DeActivateLPM
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:345    .text.HAL_PCDEx_DeActivateLPM:0000003c $d
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:350    .text.HAL_PCDEx_BCD_VBUSDetect:00000000 $t
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:356    .text.HAL_PCDEx_BCD_VBUSDetect:00000000 HAL_PCDEx_BCD_VBUSDetect
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:706    .text.HAL_PCDEx_BCD_Callback:00000000 HAL_PCDEx_BCD_Callback
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:592    .text.HAL_PCDEx_DeActivateBCD:00000000 HAL_PCDEx_DeActivateBCD
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:510    .text.HAL_PCDEx_ActivateBCD:00000000 $t
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:516    .text.HAL_PCDEx_ActivateBCD:00000000 HAL_PCDEx_ActivateBCD
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:586    .text.HAL_PCDEx_DeActivateBCD:00000000 $t
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:656    .text.HAL_PCDEx_LPM_Callback:00000000 $t
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:662    .text.HAL_PCDEx_LPM_Callback:00000000 HAL_PCDEx_LPM_Callback
C:\Users\Su\AppData\Local\Temp\ccDPELKY.s:700    .text.HAL_PCDEx_BCD_Callback:00000000 $t

UNDEFINED SYMBOLS
HAL_GetTick
HAL_Delay
